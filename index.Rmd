---
title: "index.Rmd"
author: "Ella Vainio"
date: "28 helmikuuta 2017"
output:
  html_document:
    theme: cosmo
    toc: true
    toc_depth: 2
    fig_caption: true
    fig_width: 10
    fig_height: 8
    code_folding: show 

---
ella.vainio@helsinki.fi

#IODS-final

###Childrens food poisoning 

In my final task I will be doing a Multiple Correspondence Analysis on the Poison data frame from the FactoMiner package. 

The data consists of a sample of 55 children in primary school that has suffered from food poisoning. So the data consists of the information that the children gave regardning what symptoms they had and what they had eaten prior to the food poisoning. 

Here I shall present the structure of the poison data frame. As we can see the data consists of 15 variables and 55 observations. The two first variables 'Age' and 'Time' measures how old the child was during the food poisoning, and what time this occured. There is also a variable that measures the gender of the child. There is a also cathegory of what kind of symptomes the child did or didn't expirienced during the food poisoning, that were 'sick', 'nausea', 'vomiting', 'abdominals', 'fever' and 'diarrhae'. The rest of the variables finds out what sort of food the child had eaten or not eaten prior to the food poisoning. The alternatives were 'potato', 'fish', 'mayo', 'courgette', 'cheese' and 'icecream'. 

The data is classified in yes or no, wheter the child expirienced a specific symptome or not, and if the child had eaten a specific sort of food or not

```{r message=FALSE, warning=FALSE, echo=FALSE}
library(FactoMineR)
library(ggplot2)
library(tidyr)
library(corrplot)
library(dplyr)
library(MASS)
```

```{r}
data("poison")
```


```{r echo=FALSE}
str(poison)
```
The cariables are meaured either one or two. Number one means that the specific symptome of the specific food was not a part of the food poisoning, and number two indicates that it has accured. 

Here I will present the summary of the poison data frame, and we can see easily how many of the children had what kinds of symptomes. For example 17 of the children did not feel sick at the time of the food poisoning, when 38 of the children did. We san see that what kind of symptomes as a much larger variation in comparion to the foods the children had eaten prior to the food poisoning. 

```{r echo=FALSE}
summary(poison)
```

```{r message=FALSE, warning=FALSE, error=FALSE}
gather(poison) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
```
From this table we can visualize the specific distribution of a variable. Here we can see that the least common symptome of food poisoning in this sample is nausea, and the more common symptomes for food poisoning is diarrhea, fever, abdominal (pain) and sickess. 

But we can see that there is something odd in the age variable. The data should only consist of children in primary school, but there are also much higher values in the data i.e. 88 years being the maximum age. 




###Modified data

Because there is such a small difference in what the children had eaten prior to the food poisoning, I will only be focusing on the symptomes they had. So I created a data set 'poison_reason' to explore further. I also changed the 'age' variable, so that the age group is between 0-20, because the target group was primary school children. This change in the data led to excluding 7 individuals, so we are down to 47 observaions. Otherwise the data consists of all the different symptomes of food poisoning.

I will be presenting the structure of the new data frame, summary and also a visual distribution of the different chategorical variables. 

```{r echo=FALSE}
poison_reason <-read.csv("poison_reason2.csv", sep = ",", header = TRUE)
```

```{r echo=FALSE}
poison_reason <- poison_reason[-1]
```


```{r}
str(poison_reason)
```

As we can see, the data consists of 6 variables and 47 observations of children that had food poisoning, and what kind of symptomes they had. All the variables are chategorize that conist of having or not having the symptome during the food poisoning.

```{r}
summary(poison_reason)
```

Here we can see that the most common symptome during food poisoning in this sample of primary school children is sickness. 




```{r warning=FALSE, error=FALSE, message=FALSE}
gather(poison_reason) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()
```

Here is a clear structure on how the different symptomes are distributed. The least common form of symptome during the food poisoning is nausea. 


###Multiple Correspondence Analysis

Multiple Correspondence Analysis is a way of analyzing more than two chategorical variables at once. This method is used to compare relationships between different variables. This is specifically used only with many chategorical variables. Multiple Correspondence Analysis is similar to Principal Component Analysis, where they differ in MCA focusing on qualitative data and PCA on quantitative data.  

```{r}
mca <- MCA(poison_reason, graph = FALSE)
```

To summarise the MCA on the poison_reason data frame, there are 4 different things that needs to be interpeted: eigenvalues, individuals, categories and categorical variables. 

####*Eigenvalues*
The eigenvalues describe how much of the variance in the data is explained by each dimension. The first dimension explains 68,7% of the variation in the variance. The first dimension always has the highest procent of the variance explained. The next dimension will have the next highest variance and so forth. But the bigger the explained variance there is, the better the dimension.

####*Individuals*
Here we look at the 10 first individuals of the data frame, and we shall look for 3 different things: the individuals placement (coordinates), the individuals contributions in percent and the squared correlations in the dimension. And all of these things are done individually in all the 3 first dimensions. 
          
We can see that the second and forth individual has a very high squared correlation with the first dimension(0.996). They also got very high contributions to the dimension (4.289)

####*Categories*
Here we are studying the ten first categorize, and 4 different values. The categorize are sick_n, sick_y, nausea_n, nausea_y, vomit_n, vomit_y, abdo_n, abdo_y, fever_n and fever_y. So we get the category coordinates, the category contributions in percent, the squared correlations in the specific dimension, and also v.test value, that meaures if the category is over 1.96 or under -1.96 the the categories are significantly different from zero. 
         
We can see that none of the ten first values in the first dimension is between -1.96 and 1.96. This means that all the categories are significantly different from zero. 

####*Categorical variables*
Here we are looking at all the categorical variables: sick, nausea, vomit, abdo, fever and diarrahe. There we look at the squared correlation between each variable and dimension. The closer the value is to 1, the higher the correlation between the category and dimension. 
         
We can see that the first category 'sick' has a very high squared correlation with the first dimension (0.945), the second variable has the strongest squared correlation with the second dimension (0.619), and the third variable 'vomit' is quite evenly distributed between the dimensions (0.397, 0.251, 0.348 ). 



```{r}
summary(mca)
```

###Interpeting the poison_reason data frame




```{r}
plot(mca, invisible=c("ind"), habillage = "quali")
```





